<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Household Survey Form</title>
</head>
<body>
    <h1>ICSSR Sponsored Project</h1>
    <h3>“Conversion of Plastic Waste into Liquid Fuels: Multifaceted Potential and its Public Acceptance” under the special call for Vision Viksit Bharat@2047 (VVB@2047)</h3>
    <h2>Household Survey Form</h2>
    <form id="survey-form">
        <h3>Consent/Declaration</h3>
        <label>
            <input type="checkbox" name="consent_1" required>
            I'm aware that this survey is conducted as a part of the ICSSR Project titled 'Conversion of Plastic Waste into Liquid Fuels: Multifaceted Potential and its Public Acceptance' by a team from the Department of Economic Science/Chemical Engineering, IISER Bhopal.
        </label><br>
        <label>
            <input type="checkbox" name="consent_2" required>
            I understand that my participation is voluntary, and the data collected will be used solely for academic and research purposes while maintaining confidentiality.
        </label><br>

        <label>Household Head:</label>
        <input type="text" name="household_head" required><br>

        <label>Address:</label>
        <input type="text" name="address" required><br>

        <label>Number of Members:</label>
        <input type="number" name="members" required><br>

        <label>Gender:</label>
        <select name="gender">
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
        </select><br>

        <label>Marital Status:</label>
        <select name="marital_status">
            <option value="Single">Single</option>
            <option value="Married">Married</option>
            <option value="Divorced">Divorced</option>
            <option value="Widowed">Widowed</option>
        </select><br>

        <label>Employment Status:</label>
        <select name="employment_status">
            <option value="Employed">Employed</option>
            <option value="Unemployed">Unemployed</option>
            <option value="Self-Employed">Self-Employed</option>
            <option value="Student">Student</option>
            <option value="Retired">Retired</option>
        </select><br>

        <label>Monthly Income:</label>
        <input type="number" name="income" required><br>

        <label>Owns a House:</label>
        <input type="checkbox" name="owns_house"><br>

        <label>Owns a Car:</label>
        <input type="checkbox" name="owns_car"><br>

        <label>Education Level:</label>
        <select name="education">
            <option value="None">None</option>
            <option value="Primary">Primary</option>
            <option value="Secondary">Secondary</option>
            <option value="Tertiary">Tertiary</option>
        </select><br>

        <label>Health Insurance:</label>
        <input type="checkbox" name="health_insurance"><br>

        <h3>Consumption of Items</h3>
        <table border="1">
            <tr>
                <th>Item</th>
                <th>Quantity</th>
                <th>Unit</th>
                <th>Price per Unit</th>
                <th>Total Cost</th>
            </tr>
            <tr>
                <td>Item A</td>
                <td><input type="number" name="item_a_quantity" class="quantity" required></td>
                <td>
                    <select name="item_a_unit">
                        <option value="Kg">Kg</option>
                        <option value="Ltr">Ltr</option>
                        <option value="Pack">Pack</option>
                    </select>
                </td>
                <td><input type="number" name="item_a_price" class="price" required></td>
                <td><input type="number" name="item_a_total" class="total" readonly></td>
            </tr>
            <tr>
                <td>Item B</td>
                <td><input type="number" name="item_b_quantity" class="quantity" required></td>
                <td>
                    <select name="item_b_unit">
                        <option value="Kg">Kg</option>
                        <option value="Ltr">Ltr</option>
                        <option value="Pack">Pack</option>
                    </select>
                </td>
                <td><input type="number" name="item_b_price" class="price" required></td>
                <td><input type="number" name="item_b_total" class="total" readonly></td>
            </tr>
            <tr>
                <td>Item C</td>
                <td><input type="number" name="item_c_quantity" class="quantity" required></td>
                <td>
                    <select name="item_c_unit">
                        <option value="Kg">Kg</option>
                        <option value="Ltr">Ltr</option>
                        <option value="Pack">Pack</option>
                    </select>
                </td>
                <td><input type="number" name="item_c_price" class="price" required></td>
                <td><input type="number" name="item_c_total" class="total" readonly></td>
            </tr>
            <tr>
                <td>Item D</td>
                <td><input type="number" name="item_d_quantity" class="quantity" required></td>
                <td>
                    <select name="item_d_unit">
                        <option value="Kg">Kg</option>
                        <option value="Ltr">Ltr</option>
                        <option value="Pack">Pack</option>
                    </select>
                </td>
                <td><input type="number" name="item_d_price" class="price" required></td>
                <td><input type="number" name="item_d_total" class="total" readonly></td>
            </tr>
        </table>

        <button type="submit">Submit</button>
                        <h3>Section 2: Household Size - Family Member Details</h3>
        <table border="1">
            <tr>
                <th>Name of the Household Member</th>
                <th>Relation with the Head</th>
                <th>Gender</th>
                <th>Marital Status</th>
                <th>Highest Educational Level</th>
                <th>Occupation</th>
                <th>Monthly Income</th>
            </tr>
            <tr>
                <td><input type="text" name="member_name[]" required></td>
                <td><input type="text" name="relation[]" required></td>
                <td>
                    <select name="gender[]">
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </td>
                <td>
                    <select name="marital_status[]">
                        <option value="Single">Single</option>
                        <option value="Married">Married</option>
                        <option value="Divorced">Divorced</option>
                        <option value="Widowed">Widowed</option>
                    </select>
                </td>
                <td><input type="text" name="education[]" required></td>
                <td><input type="text" name="occupation[]" required></td>
                <td><input type="number" name="income[]" required></td>
            </tr>
        </table>
        <button type="button" onclick="addRow()">Add Member</button>

        <script>
            function addRow() {
                let table = document.querySelector("table");
                if (table.rows.length >= 13) {
                    alert("You can only add up to 12 members.");
                    return;
                }
                let table = document.querySelector("table");
                let newRow = table.insertRow(-1);
                let cols = ["member_name", "relation", "gender", "marital_status", "education", "occupation", "income"];
                let options = {
                    gender: ["Male", "Female", "Other"],
                    marital_status: ["Single", "Married", "Divorced", "Widowed"]
                };
                cols.forEach(col => {
                    let cell = newRow.insertCell(-1);
                    if (options[col]) {
                        let select = document.createElement("select");
                        select.name = col + "[]";
                        options[col].forEach(opt => {
                            let option = document.createElement("option");
                            option.value = opt;
                            option.text = opt;
                            select.appendChild(option);
                        });
                        cell.appendChild(select);
                    } else {
                        let input = document.createElement("input");
                        input.type = col === "income" ? "number" : "text";
                        input.name = col + "[]";
                        input.required = true;
                        cell.appendChild(input);
                    }
                });
            }
                    document.getElementById('survey-form').addEventListener('submit', function(event) {
                event.preventDefault();
                const formData = new FormData(event.target);
                
                fetch('https://script.google.com/macros/s/AKfycbwqlfBt4CQQEsz21KYztg5oeclXN_BzPF44bxZ5A_2xlEispIoDv0loMINh0rfBoZEC5Q/exec', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => alert(data.message))
                .catch(error => console.error('Error:', error));
            });
        </script>
    </form>

    <script>
        document.querySelectorAll('.quantity, .price').forEach(input => {
            input.addEventListener('input', function() {
                let row = this.closest('tr');
                let quantity = row.querySelector('.quantity').value;
                let price = row.querySelector('.price').value;
                let totalField = row.querySelector('.total');
                totalField.value = quantity * price;
            });
        });

        document.getElementById('survey-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            fetch('/submit', {
                method: 'POST',
                body: new URLSearchParams(formData)
            })
            .then(response => response.json())
            .then(data => alert(data.message));
        });
    </script>
</body>
</html>
